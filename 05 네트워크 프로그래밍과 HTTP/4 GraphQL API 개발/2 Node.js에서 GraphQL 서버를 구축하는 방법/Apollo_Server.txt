Node.js에서 GraphQL 서버를 구축하는 방법
Apollo Server
- GraphQL 서버를 구축하기 위한 오픈 소스 라이브러리
- Facebook에서 개발한 GraphQL을 좀 더 쉽게 사용할 수 있도록 도와주는 도구
- 다양한 언어와 프레임워크에서 사용할 수 있으며, Node.js, JavaScript, TypeScript 등에서 널리 사용
- 사용하면 GraphQL 스키마를 정의하고 리졸버 함수를 작성하여 GraphQL API를 만들 수 있음
- 스키마는 사용 가능한 타입과 타입 간의 관계를 정의하며, 클라이언트가 요청할 수 있는 쿼리의 구조를 명시
- 리졸버 함수는 스키마의 각 필드에 대한 동작을 정의하고, 해당 필드의 데이터를 가져오거나 가공하는 역할을 수행

Apollo Server의 주요 특징
강력한 개발 도구
- 개발자가 GraphQL API를 구축하고 유지 관리하기 쉽도록 다양한 개발 도구를 제공
- GraphQL Playground를 제공하여 API를 테스트하고 문서화 가능

데이터 소스 통합
- 다양한 데이터 소스와 통합 가능
- 데이터베이스, 외부 서비스, REST API 등 다양한 데이터 소스로부터 데이터를 가져와 GraphQL API를 통해 클라이언트에게 제공

성능 최적화
- 쿼리의 실행 계획을 최적화하여 데이터를 효율적으로 가져올 수 있도록 도움
- 캐싱, 배치 처리 등의 기능을 제공하여 네트워크 요청의 수를 최소화하고 응답 속도를 향상

확장성
- 스키마의 모듈화와 스키마의 분할 등의 기능을 제공하여 복잡한 API를 구축하고 확장하기 쉽게 함
- 여러 개발자가 동시에 작업할 수 있고, 코드를 재사용하고 조직화 가능

1.Apollo Server 설치
- GraphQL 서버를 쉽게 구축할 수 있는 도구
- npm install apollo-server

2. 스키마를 정의
- 서버를 구축하기 위해 먼저 스키마를 정의
- 스키마는 GraphQL API의 계약서 역할을 하며, 사용 가능한 타입과 타입 간의 관계를 정의
- 스키마는 GraphQL 스키마 언어 (SDL) 또는 프로그래밍 언어를 사용하여 작성

const { gql } = require('apollo-server');

const typeDefs = gql`
  type Query {
    hello: String
  }
`;

3. 리졸버 함수를 작성
- 리졸버 함수는 스키마의 필드에 대한 동작을 정의하는 함수
- 각 필드에 대한 리졸버 함수를 작성하여 해당 필드의 데이터를 가져오거나 가공

const resolvers = {
  Query: {
    hello: () => 'Hello, World!'
  }
};

4. Apollo Server 생성
- Apollo Server를 생성하여 GraphQL 서버를 구축

const { ApolloServer } = require('apollo-server');

const server = new ApolloServer({
  typeDefs,
  resolvers
});

server.listen().then(({ url }) => {
  console.log(`GraphQL 서버가 ${url}에서 실행 중입니다.`);
});

- typeDefs와 resolvers를 옵션으로 전달하여 Apollo Server를 생성
- listen() 메서드를 호출하여 서버를 실행하고, 서버가 리슨하는 주소를 출력

5. 클라이언트의 GraphQL 쿼리에 대한 응답
- Apollo Server가 실행되면 클라이언트가 GraphQL 쿼리를 보낼 수 있음
- 클라이언트의 쿼리는 스키마에 정의된 필드를 요청하고, 서버는 해당 필드에 대한 리졸버 함수를 실행하여 응답을 생성
- 클라이언트가 hello 필드에 대한 쿼리를 보낼 경우 서버는 리졸버 함수를 실행하고 "Hello, World!"라는 응답을 반환합니다.